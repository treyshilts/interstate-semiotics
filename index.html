<body>
    <img src="stretchhighway.png" alt="hi" width="700px">
    <h1>etc</h1>
    <br>
    <p>ongoing internet posts and writing of trey shilts</p>
    <br>
    <p> 
        <a href="https://bathroomposting.substack.com/">my email list</a> | <a href="https://bathroomposting.substack.com/archive">archive</a> | 
        <a href="https://www.finnishpostcard.com/">finnish postcard site</a>
    </p>
    <br>
    <h3>/*/*/*/*/*/*/*/*/</h3>
    <br>
    <div id="feed"></div>
    <script>
        async function fetchSubstackFeedDirectly() {
            const url = 'https://bathroomposting.substack.com/feed';
            const response = await fetch(url);
            const text = await response.text();

            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(text, "text/xml");

            const items = xmlDoc.querySelectorAll("item");
            const feedContainer = document.getElementById('feed');
            feedContainer.innerHTML = '';

            items.forEach(item => {
                const title = item.querySelector("title").textContent;
                const link = item.querySelector("link").textContent;
                const pubDate = item.querySelector("pubDate").textContent;
                const description = item.querySelector("description").textContent;

                // Extract only the first image from the description
                const descDoc = parser.parseFromString(description, 'text/html');
                const firstImageElement = descDoc.querySelector('img');
                let firstImage = '';
                if (firstImageElement) {
                    firstImageElement.classList.add('featured-image');
                    firstImage = firstImageElement.outerHTML;
                }

                // Remove all other images
                descDoc.querySelectorAll('img').forEach(img => img.remove());

                const postElement = document.createElement('div');
                postElement.classList.add('post');
                postElement.innerHTML = `
                    <h2><a href="${link}" target="_blank">${title}</a></h2>
                    ${firstImage}
                    <div>${descDoc.body.innerHTML}</div>
                    <p><strong>Published:</strong> ${new Date(pubDate).toLocaleDateString()}</p>
                `;

                feedContainer.appendChild(postElement);
            });
        }

        fetchSubstackFeedDirectly();
    </script>
</body>
</html>
